# ============================================
# Screen-compatible tmux configuration
# ============================================
#
# Quick Reference (screen-equivalent bindings):
#
# | Action          | Binding        |
# |-----------------|----------------|
# | New window      | Ctrl-a c       |
# | Kill window     | Ctrl-a k       |
# | Next window     | Ctrl-a n       |
# | Prev window     | Ctrl-a p       |
# | Last window     | Ctrl-a Ctrl-a  |
# | Rename window   | Ctrl-a A       |
# | List windows    | Ctrl-a "       |
# | Horizontal split| Ctrl-a S       |
# | Vertical split  | Ctrl-a |       |
# | Next pane       | Ctrl-a Tab     |
# | Kill pane       | Ctrl-a X       |
# | Scrollback mode | Ctrl-a Esc     |
# | Monitor activity| Ctrl-a M       |
# | Toggle logging  | Ctrl-a H       |
# | Paste           | Ctrl-a ]       |
# | Detach          | Ctrl-a d       |
# | Command prompt  | Ctrl-a :       |
# | Key bindings    | Ctrl-a ?       |
# | Window 0-9      | Ctrl-a 0-9     |
# | Window list bar | Ctrl-a w       |
# | Copy mode (alt) | Ctrl-a [       |
# | Redraw screen   | Ctrl-a l       |
# | Lock session    | Ctrl-a x       |
# | Monitor silence | Ctrl-a _       |
# | Goto window     | Ctrl-a '       |
# | Suspend         | Ctrl-a z       |

# --- Prefix ---
# Use Ctrl-a as prefix (like screen) instead of Ctrl-b
set -g prefix C-a
unbind C-b
bind C-a send-prefix

# --- Window Management ---
# Ctrl-a c       - new window (same as screen, already default)
# Ctrl-a k       - kill window (screen uses k, tmux default is &)
bind k confirm-before -p "kill-window #W? (y/n)" kill-window
# Ctrl-a K       - kill window without confirmation
bind K kill-window
# Ctrl-a Ctrl-a  - switch to last window (screen default)
bind C-a last-window
# Ctrl-a A       - rename window (screen uses A, tmux default is ,)
bind A command-prompt "rename-window '%%'"
# Ctrl-a "       - list windows (screen uses ", tmux default is w)
bind '"' choose-window

# --- Splits (screen region style) ---
# Ctrl-a S       - horizontal split (screen uses S)
bind S split-window -v
# Ctrl-a |       - vertical split (screen uses |)
bind | split-window -h
# Ctrl-a Tab     - move to next pane (screen uses Tab)
bind Tab select-pane -t :.+
# Ctrl-a X       - kill current pane (screen uses X for region)
bind X kill-pane
# Ctrl-a Q       - close all panes except current (screen uses Q)
bind Q break-pane

# --- Copy/Scrollback ---
# Ctrl-a Escape  - enter copy/scrollback mode (screen uses Escape)
bind Escape copy-mode
# Ctrl-a [       - enter copy mode (screen also uses [)
bind [ copy-mode
# Ctrl-a ]       - paste (same as screen, already default)
# Vi keybindings in copy mode (hjkl movement, v to select, y to yank)
setw -g mode-keys vi
bind -T copy-mode-vi v send-keys -X begin-selection
bind -T copy-mode-vi y send-keys -X copy-pipe-and-cancel "pbcopy"
bind -T copy-mode-vi MouseDragEnd1Pane send-keys -X copy-pipe-and-cancel "pbcopy"

# --- Monitoring ---
# Ctrl-a M       - toggle activity monitoring on current window (screen uses M)
bind M setw monitor-activity \; display "Monitor activity: #{?monitor-activity,ON,OFF}"
# Ctrl-a _       - toggle silence monitoring on current window (screen uses _)
bind _ setw monitor-silence 30 \; display "Monitor silence: #{?monitor-silence,ON (30s),OFF}"

# --- Logging ---
# Ctrl-a H       - toggle logging to file (screen uses H)
bind H pipe-pane -o "cat >> #{pane_current_path}/tmux-#W.log" \; display "Toggled logging to tmux-#W.log"

# --- Display ---
# Ctrl-a w       - show window list in status bar (screen uses w)
bind w choose-window
# Ctrl-a l       - redraw/refresh screen (screen uses l)
bind l refresh-client
# Ctrl-a '       - prompt for window number/name to switch to (screen uses ')
bind "'" command-prompt -p "Select window:" "select-window -t '%%'"

# --- Session ---
# Ctrl-a x       - lock session (screen uses x)
bind x lock-server
set -g lock-command "vlock"
# Ctrl-a z       - suspend tmux (screen uses z)
bind z suspend-client

# --- Misc ---
# Ctrl-a :       - command prompt (same as screen, already default)
# Ctrl-a ?       - show key bindings (same as screen, already default)
# Ctrl-a d       - detach (same as screen, already default)
# Ctrl-a n/p     - next/prev window (same as screen, already default)
# Ctrl-a 0-9     - switch to window N (same as screen, already default)

# Enable mouse support (scroll, click to select pane, drag to select text)
set -g mouse on

# Start window numbering at 1 (screen starts at 0 but 1 is more ergonomic)
set -g base-index 1

# 256 color support
set -g default-terminal "xterm-256color"

# Increase scrollback buffer (screen default is 100, this is more useful)
set -g history-limit 10000
